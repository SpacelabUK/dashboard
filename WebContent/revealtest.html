<!doctype html>
<html lang="en">

<head>
<meta charset="utf-8">
<style>
.x path, .x line, .y path, .y line {
	fill: none;
	stroke-width: 1px;
	stroke: gray;
}
</style>
<title>reveal.js - Barebones</title>

<link rel="stylesheet" href="css/reveal.css">
<link rel="stylesheet" href="css/theme/splab-classic.css" id="theme">
</head>

<body style="font-family: Apercu">

  <div class="reveal">

    <div class="slides">

      <section>
        <div style="width: 100%; height: 100%; position: relative;"
          id="slide-1">
          <div style="position: absolute; left: 0; top: 0; right: 0">
            <hr />
          </div>
          <h2
            style="position: absolute; left: 0; top: 2rem; color: #6C6C6C">Workplace
            study results</h2>
          <h2 style="position: absolute; left: 0; top: 4rem">Boden</h2>
          <h2
            style="position: absolute; right: 0; top: 2rem; color: #149FEB">Can
            we make better use of space?</h2>
          <h2 style="position: absolute; right: 0; top: 4rem">Space
            planned to suit occupancy levels</h2>
          <div
            style="font-size: 1.2rem; left: 0; top: 7em; bottom: 0; width: 17.4rem; position: absolute;">
            <ol>
              <li>Excess of 145 desks compared with 100% headcount
                (607 for 462 staff), although only 69 desks were empty
                all week, indicating that some people are sometimes
                using desks that are not their own or have more than one
                desk allocated</li>
              <li>Average 76% staff on site (353 people) compared
                with perception of 95%</li>
              <li>Maximum observed was 86% (419 on Tuesday,
                10:00-11:00); minimum was 34% (168 on Friday
                17:00-18:00)</li>
              <li>If people worked from home as they would like*,
                average occupancy would drop by around 19%, to around
                57%</li>
              <li>Stakeholder desire for staff to be ‘out and
                about’ more of the time – which would also impact on
                occupancy levels</li>
            </ol>
          </div>
          <span
            style="font-size: 1.2rem; left: 20rem; top: 41rem; position: absolute; width: 2em; text-align: right;">462</span>
          <span
            style="font-size: 1.2rem; left: 23rem; top: 41rem; position: absolute;">Headcount</span>
          <span
            style="font-size: 1.2rem; left: 20rem; top: 42.5rem; position: absolute; width: 2em; text-align: right;">607</span><span
            style="font-size: 1.2rem; left: 23rem; top: 42.5rem; position: absolute;">Desks
            observed</span> <span
            style="font-size: 1.2rem; left: 20rem; top: 44rem; position: absolute; width: 2em; text-align: right;">145</span><span
            style="font-size: 1.2rem; left: 23rem; top: 44rem; position: absolute;">Excess
            desks over headcount</span> <span
            style="font-size: 1.2rem; left: 20rem; top: 45.5rem; position: absolute; width: 2em; text-align: right;">69</span><span
            style="font-size: 1.2rem; left: 23rem; top: 45.5rem; position: absolute;">Desks
            empty all week</span>
          <svg id="graph-1"
            style="position: absolute; left: 40rem; top: 40rem; width: 15rem; height: 15rem">
          </svg>
          <svg id="graph-2"
            style="position: absolute; left: 20rem; top: 15rem; width: 57rem; height: 22rem"></svg>
          <p
            style="font-size: 1.2rem; left: 59rem; top: 40rem; position: absolute; width: 15rem;"
            class="stakeholder-speech stakeholder-speech-bottom speech-right">“We
            don't get out enough! We need to be ‘out there’ to increase
            our awareness of what's going on” (Stakeholder)</p>
        </div>
      </section>
      <section>
        <div style="width: 100%; height: 100%; position: relative;"
          id="slide-1">
          <div style="position: absolute; left: 0; top: 0; right: 0">
            <hr />
          </div>
          <h2
            style="position: absolute; left: 0; top: 2rem; color: #6C6C6C">Workplace
            study results</h2>
          <h2 style="position: absolute; left: 0; top: 4rem">Boden</h2>
          <h2
            style="position: absolute; right: 0; top: 2rem; color: #149FEB">Can
            we make better use of space?</h2>
          <h2 style="position: absolute; right: 0; top: 4rem">Efficient
            desk occupation</h2>
          <div
            style="font-size: 1.2rem; left: 0; top: 7em; bottom: 0; width: 17.4rem; position: absolute;">
            <ol>
              <li>Inefficient desk occupancy (average 44%)</li>
              <li>Maximum occupancy only 54% (Monday, 13:30-14:30
                and Tuesday, 11:30-12:30)</li>
              <li>Even less efficient in 13 cellular offices (34%)
                compared with open plan (44%)</li>
            </ol>
          </div>
          <span
            style="font-size: 1.2rem; left: 23rem; top: 15.5rem; position: absolute; text-align: center; width: 16rem;">Average*</span>
          <svg id="graph-3"
            style="position: absolute; left: 23rem; top: 18rem; width: 16rem; height: 16rem">
          </svg>
          <span
            style="font-size: 1.2rem; left: 48rem; top: 18rem; position: absolute; text-align: center; width: 12rem;">Maximum</span>

          <svg id="graph-4"
            style="position: absolute; left: 48rem; top: 20rem; width: 12rem; height: 12rem">
          </svg>
          <span
            style="font-size: 1.2rem; left: 63rem; top: 18rem; position: absolute; text-align: center; width: 12rem;">Minimum</span>

          <svg id="graph-5"
            style="position: absolute; left: 63rem; top: 20rem; width: 12rem; height: 12rem">
          </svg>
          <span
            style="font-size: 1.2rem; left: 49rem; top: 36rem; position: absolute; text-align: center; width: 10rem;">Open
            plan average</span>

          <svg id="graph-6"
            style="position: absolute; left: 48rem; top: 40rem; width: 12rem; height: 12rem">
          </svg>
          <span
            style="font-size: 1.2rem; left: 64rem; top: 36rem; position: absolute; text-align: center; width: 10rem;">Cellular
            offices average</span>

          <svg id="graph-7"
            style="position: absolute; left: 63rem; top: 40rem; width: 12rem; height: 12rem">
          </svg>

          <span
            style="font-size: 1.4rem; left: 19.5rem; top: 38rem; position: absolute; width: 2em; text-align: right;">607</span>
          <span
            style="font-size: 1.4rem; left: 23rem; top: 38rem; position: absolute;">Total
            number of desks</span> <span
            style="font-size: 1.2rem; left: 20rem; top: 41rem; position: absolute; width: 2em; text-align: right;">572</span>
          <span
            style="font-size: 1.2rem; left: 23rem; top: 41rem; position: absolute;">in
            open plan</span> <span
            style="font-size: 1.2rem; left: 20rem; top: 42.5rem; position: absolute; width: 2em; text-align: right;">20</span><span
            style="font-size: 1.2rem; left: 23rem; top: 42.5rem; position: absolute;">in
            cellular offices </span> <span
            style="font-size: 1.2rem; left: 20rem; top: 44rem; position: absolute; width: 2em; text-align: right;">1</span><span
            style="font-size: 1.2rem; left: 23rem; top: 44rem; position: absolute;">in
            post room</span> <span
            style="font-size: 1.2rem; left: 20rem; top: 45.5rem; position: absolute; width: 2em; text-align: right;">3</span><span
            style="font-size: 1.2rem; left: 23rem; top: 45.5rem; position: absolute;">in
            reception</span> <span
            style="font-size: 1.2rem; left: 20rem; top: 47rem; position: absolute; width: 2em; text-align: right;">2</span><span
            style="font-size: 1.2rem; left: 23rem; top: 47rem; position: absolute;">in
            security room</span> <span
            style="font-size: 1.2rem; left: 20rem; top: 48.5rem; position: absolute; width: 2em; text-align: right;">6</span><span
            style="font-size: 1.2rem; left: 23rem; top: 48.5rem; position: absolute;">in
            fitting rooms and studios</span> <span
            style="font-size: 1.2rem; left: 20rem; top: 50rem; position: absolute; width: 2em; text-align: right;">3</span><span
            style="font-size: 1.2rem; left: 23rem; top: 50rem; position: absolute;">in
            meeting rooms</span> <span
            style="font-size: 1.2rem; left: 20rem; top: 51.5rem; position: absolute; width: 2em; text-align: right;">69</span><span
            style="font-size: 1.2rem; left: 23rem; top: 51.5rem; position: absolute;">desks
            empty all week</span> <span
            style="font-size: .9rem; left: 20rem; top: 54rem; position: absolute;">*
            Excluding empty desks</span>
        </div>
      </section>

      <section>
        <div style="width: 100%; height: 100%; position: relative;"
          id="slide-1">
          <div style="position: absolute; left: 0; top: 0; right: 0">
            <hr />
          </div>
          <h2
            style="position: absolute; left: 0; top: 2rem; color: #6C6C6C">Workplace
            study results</h2>
          <h2 style="position: absolute; left: 0; top: 4rem">Boden</h2>
          <h2
            style="position: absolute; right: 0; top: 2rem; color: #149FEB">Can
            we make better use of space?</h2>
          <h2 style="position: absolute; right: 0; top: 4rem">Efficient
            desk occupation</h2>
          <div
            style="font-size: 1.2rem; left: 0; top: 7em; bottom: 0; width: 17.4rem; position: absolute;">
            <ol>
              <li>In the larger teams (15+ people), which account
                for 85% desks, peak occupancy never exceeds 70% (except
                Mini & Johnnie b Merchandising 88%; Finance 86%; and
                Womenswear Merchandising 76%)</li>
              <li>This indicates potential for a non-allocated desk
                strategy</li>
            </ol>
          </div>
          <svg id="graph-8"
            style="position: absolute; left: 20rem; top: 15rem; width: 57rem; height: 35rem"></svg>

        </div>
      </section>
      <section>
        <div style="width: 100%; height: 100%; position: relative;"
          id="slide-1">
          <div style="position: absolute; left: 0; top: 0; right: 0">
            <hr />
          </div>
          <h2
            style="position: absolute; left: 0; top: 2rem; color: #6C6C6C">Workplace
            study results</h2>
          <h2 style="position: absolute; left: 0; top: 4rem">Boden</h2>
          <h2
            style="position: absolute; right: 0; top: 2rem; color: #149FEB">Can
            we make better use of space?</h2>
          <h2 style="position: absolute; right: 0; top: 4rem">Efficient
            primary circulation</h2>
          <div
            style="font-size: 1.2rem; left: 0; top: 7em; bottom: 0; width: 17.4rem; position: absolute;">
            <ol>
              <li>Overall inefficient primary circulation which
                takes up 21% NIA (1,664 sqm), compared with 15% best
                practice benchmark</li>
              <li>Primary circulation particularly inefficient in
                Boden House (23% NIA)</li>
            </ol>
          </div>
          <div
            style="position: absolute; top: 14rem; left: 20rem; width: 57rem; height: 30rem;"></div>
          <svg id="graph-9"
            style="position: absolute; left: 23rem; top: 18rem; width: 16rem; height: 16rem">
          </svg>
          <span
            style="font-size: 1.2rem; left: 20rem; top: 36rem; position: absolute; text-align: center; width: 10rem;">Boden
            House (6,101 sqm)</span>

          <svg id="graph-10"
            style="position: absolute; left: 20rem; top: 40rem; width: 10rem; height: 10rem">
          </svg>
          <span
            style="font-size: 1.2rem; left: 31rem; top: 36rem; position: absolute; text-align: center; width: 12rem;">Black
            Arrow House (2,008 sqm)</span>

          <svg id="graph-11"
            style="position: absolute; left: 32rem; top: 40rem; width: 10rem; height: 10rem">
          </svg>
          <span
            style="font-size: 1.2rem; left: 50rem; top: 19rem; position: absolute; width: 27rem; text-align: left;">Primary
            Circulation</span>
          <svg viewBox="0 0 1280 726"
            style="position: absolute; left: 50rem; top: 20rem; width: 27rem; height: 16rem"
            preserveAspectRatio="xMidYMid meet">
            <image xlink:href="/Database/data/plans/55_BH_GF.png"
              width="1280" height="726" y="0" x="0"></image>
            <g>
            <path fill="red"
              d="M510,617L517,617L517,601L562,601L562,617L526,617L526,637L517,637L517,655L380,655L380,639L404,639L404,601L387,601L387,586L376,586L376,584L375,584L375,594L330,594L330,596L330,596L330,608L310,608L310,620L310,620L310,639L296,639L296,596L305,596L305,594L292,594L292,586L236,586L236,595L222,595L223,567L285,567L285,568L375,568L375,570L376,570L376,570L399,570L399,586L419,586L419,639L510,639L510,617"></path></g>
            <g>
            <path fill="red"
              d="M75,523L76,523L77,564L97,564L97,526L182,526L182,524L187,524L187,564L221,564L221,544L259,544L259,546L222,546L222,564L285,564L285,317L263,317L263,243L285,243L285,102L285,102L285,90L289,90L289,103L305,103L305,65L289,65L289,90L285,90L285,49L282,48L282,47L246,47L246,92L228,92L228,47L176,47L176,54L175,54L175,47L96,47L96,69L176,69L177,110L195,110L195,248L187,248L187,317L224,317L224,348L187,348L187,375L225,375L225,504L187,504L187,507L76,507L76,510L75,510L75,506L47,506L47,547L75,547L75,523"></path></g>
            <g>
            <path fill="red"
              d="M1215,674L1215,647L1197,647L1197,663L1143,663L1143,620L1157,620L1157,629L1191,629L1191,595L1191,595L1191,528L1157,528L1157,504L1192,504L1192,502L1143,502L1143,478L1143,478L1143,383L1049,383L1049,355L1143,355L1143,223L1130,223L1130,198L1143,198L1143,137L1143,137L1143,132L1144,132L1144,87L1136,87L1136,81L1051,81L1051,58L1078,58L1078,68L1097,68L1097,49L1108,49L1108,57L1151,57L1151,49L1167,49L1167,132L1168,132L1168,157L1164,157L1164,264L1168,264L1168,317L1161,317L1161,337L1160,337L1160,390L1165,390L1165,478L1217,478L1217,502L1215,502L1215,504L1216,504L1216,595L1234,595L1234,622L1260,622L1260,647L1237,647L1237,649L1260,649L1260,674L1215,674"></path></g>
            <g>
            <path fill="red"
              d="M740,438L740,440L739,440L739,438L529,438L529,440L528,440L528,438L317,438L317,327L289,327L289,509L317,509L317,465L528,465L528,464L529,464L529,465L739,465L739,464L740,464L740,465L978,465L978,327L951,327L951,438L740,438"></path></g>
            <g>
            <path fill="red"
              d="M984,397L984,312L960,312L960,191L861,191L861,236L807,236L807,191L681,191L681,235L625,235L625,191L479,191L479,235L460,235L460,191L421,191L421,235L403,235L403,191L389,191L389,312L371,312L371,191L290,191L290,173L394,173L394,137L412,137L412,173L424,173L424,137L442,137L442,173L475,173L475,137L493,137L493,173L532,173L532,137L550,137L550,173L873,173L873,137L891,137L891,173L960,173L960,172L978,172L978,298L984,298L984,295L999,295L999,325L1004,325L1004,319L1014,319L1014,334L1046,334L1046,397L984,397"></path></g>
            <g>
            <path fill="red"
              d="M1051,637L1075,637L1075,641L1102,641L1105,641L1109,642L1112,643L1118,645L1119,646L1119,646L1120,646L1121,646L1121,645L1121,645L1121,620L1139,620L1139,663L1090,663L1051,663L1051,662L1046,662L1046,667L1020,667L1020,666L1012,666L1012,666L1003,666L1003,666L982,666L982,666L964,666L964,660L907,660L907,645L855,645L855,636L661,636L661,624L568,624L568,618L563,618L563,601L565,601L565,599L580,599L580,584L600,584L600,593L609,593L609,584L640,584L640,602L647,602L647,601L655,601L655,584L740,584L740,601L747,601L747,584L790,584L790,617L791,617L791,618L885,618L885,629L927,629L927,640L994,640L994,584L1012,584L1012,641L1020,641L1020,631L1046,631L1046,641L1051,641L1051,637M753,590L753,594L774,594L774,590L753,590M715,590L715,594L736,594L736,590L715,590M591,590L591,584L583,584L583,590L591,590M614,590L614,594L635,594L635,590L614,590M690,590L690,594L711,594L711,590L690,590M664,590L664,594L685,594L685,590L664,590"></path></g>
            </svg>

          <span
            style="font-size: 1.2rem; left: 50rem; top: 36rem; position: absolute; width: 27rem; text-align: left;">Boden
            House (Ground Floor)</span>
          <svg viewBox="0 0 1280 404"
            style="position: absolute; left: 50rem; top: 37rem; width: 20rem; height: 16rem"
            preserveAspectRatio="xMidYMid meet">
            <image xlink:href="/Database/data/plans/55_BAH_F3.png"
              width="1280" height="404" y="0" x="0"></image>
            <g>
            <path fill="red"
              d="M1053,275L1053,275L1059,275L1059,315L1025,315L1025,275L136,275L136,264L121,264L121,206L191,206L191,232L252,232L252,236L271,236L271,207L366,207L366,236L519,236L519,208L1025,208L1025,146L1058,146L1058,181L1053,181L1053,208L1053,208L1053,275L1053,275"></path></g>
            </svg>

          <span
            style="font-size: 1.2rem; left: 50rem; top: 49rem; position: absolute; width: 27rem; text-align: left;">Black
            Arrow House (Third Floor)</span>
        </div>
      </section>

    </div>

  </div>

  <script src="lib/reveal.js"></script>
  <script src="lib/d3.min.js"></script>

  <script>
			Reveal.initialize({
				width : 770,
				height : 580,
				center : false,
				keyboard : true,
				transition : 'fade' // none/fade/slide/convex/concave/zoom
			});
			Reveal.addEventListener('ready', function(event) {
				loadDonut();
				loadStackedChart("#graph-2");
				// event.currentSlide, event.indexh, event.indexv
			});
			Reveal.addEventListener('slidechanged', function(event) {
				if (event.indexh == 0) {
					loadDonut();
					loadStackedChart("#graph-2");
				} else if (event.indexh === 1) {
					loadSlide2();
				} else if (event.indexh === 2) {
					loadSlide3();
				} else if (event.indexh === 3) {
					loadSlide4();
				}
				// event.previousSlide, event.currentSlide, event.indexh, event.indexv
			});
			//document.addEventListener("DOMContentLoaded", function(event) {
			function loadDonut() {
				var data = [
						{
							name : "one",
							value : 95
						}, {
							name : "two",
							value : 5
						}
				];

				var margin = {
					top : 2,
					right : 2,
					bottom : 2,
					left : 2
				};
				width = 150 - margin.left - margin.right;
				height = width - margin.top - margin.bottom;

				var svg = d3.select("#graph-1");
				svg.selectAll('g').remove();
				/* svg.attr('viewbox', '0 0 ' + (width + margin.left + margin.right) +
						' ' + (height + margin.top + margin.bottom)); */
				/* .attr("width",
						width + margin.left + margin.right).attr("height",
						height + margin.top + margin.bottom) */
				var chart = svg.append("g").attr(
						"transform",
						"translate(" + ((width / 2) + margin.left) + "," +
								((height / 2) + margin.top) + ")");

				var radius = Math.min(width, height) / 2;

				var color = d3.scale.ordinal().range([
						"#2DC3F0", "#F2902A"
				]);

				var arc = d3.svg.arc().outerRadius(radius).innerRadius(radius - 40);
				var pie = d3.layout.pie().sort(null).startAngle(0)
						.endAngle(2 * Math.PI).value(function(d) {
							return d.value;
						});

				var g = chart.selectAll(".arc").data(pie(data)).enter().append("g")
						.attr("class", "arc");

				g.append("path").style('stroke', 'white')
						.style('stroke-width', '1.5px').style("fill", function(d) {
							return color(d.data.name);
						}).transition().delay(function(d, i) {
							return i * 500;
						}).duration(500).attrTween('d', function(d) {
							var i = d3.interpolate(d.startAngle + 0.1, d.endAngle);
							return function(t) {
								d.endAngle = i(t);
								return arc(d);
							}
						});
				var text = chart.selectAll('text').data(pie(data)).enter().append(
						'text').attr('font-family', 'Apercu').attr('font-size', '1rem')
						.attr('text-anchor', 'middle').attr('dy', '.3em').attr('x',
								function(d) {
									return arc.centroid(d)[0];
								}).attr('y', function(d) {
							return arc.centroid(d)[1];
						}).style('fill', 'white').transition().delay(function(d, i) {
							return 250 + i * 500;
						}).duration(250).tween('text', function(d, idx) {
							var total = 0;
							for (var i = 0; i < data.length; i++)
								total += data[i].value;
							var val = 100 * data[idx].value / total;
							var i = d3.interpolate(0, val);
							return function(t) {
								this.textContent = (i(t) | 0) + '%';
							}
						});
			}
			function loadStackedChart(elementID) {
				var margin = {
					top : 10,
					right : 10,
					bottom : 80,
					left : 40
				}, width = 570 - margin.left - margin.right, height = 150 - margin.top -
						margin.bottom;

				var svg = d3.select(elementID);
				var svgstyle = svg.node().style;
				if (svgstyle.width) {
					var w = svgstyle.width;
					if (endsWith(w, 'rem'))
						w = 10 * parseInt(w.substring(0, w.indexOf('rem')));
					else if (endsWith(w, 'px'))
						w = parseInt(w.substring(0, w.indexOf('px')));
					else
						w = 570;
					width = w - margin.left - margin.right;
				}
				if (svgstyle.height) {
					var h = svgstyle.height;
					if (endsWith(h, 'rem'))
						h = 10 * parseInt(h.substring(0, h.indexOf('rem')));
					else if (endsWith(h, 'px'))
						h = parseInt(h.substring(0, h.indexOf('px')));
					else
						h = 150;

					height = h - margin.top - margin.bottom;
				}
				svg.selectAll('g').remove();

				var x = d3.time.scale().range([
						0, width
				]);

				var y = d3.scale.linear().domain([
						0, 450
				]).range([
						height, 0
				]);
				var properties = [
						"Sitting Open Plan Own Desk" //
						, "Sitting Cellular Own Desk"//
						, "Sitting Open Plan Not Own Desk"//
						, "Sitting Cellular Not Own Desk"//
						, "Sitting in meeting rooms"//
						, "Sitting in alternative spaces"//
						, "Sitting in other facilities"//
						, "Standing"//
						, "Walking"
				];
				var color = d3.scale.ordinal().domain(properties).range([
						"#BB56A0", "#6C4D9F", "#75BE44", "#FFF209", "#83827F", "#2DC3F0", //"#2A3890", 
						"#F2902A", "#EB008C", "#A5DFF6"
				]);

				var xAxis = d3.svg.axis().scale(x).orient("bottom").ticks(40);
				xAxis.tickFormat(function(d, i) {
					return data[i].date.getHours() + ':' + data[i].date.getMinutes();
				});
				var yAxis = d3.svg.axis().scale(y).orient("left");

				var area = d3.svg.area().x(function(d) {
					/* return x(d.date); */
					return x(d.idx);
				}).y0(function(d) {
					return y(d.y0);
				}).y1(function(d) {
					return y(d.y0 + d.y);
				});

				var stack = d3.layout.stack().values(function(d) {
					return d.values;
				});

				var chart = svg.append("g").attr("transform",
						"translate(" + margin.left + "," + margin.top + ")");

				var str = "date	Sitting Cellular Not Own Desk	Sitting Cellular Own Desk	Sitting in alternative spaces	Sitting in meeting rooms	Sitting in other facilities	Sitting Open Plan Not Own Desk	Sitting Open Plan Own Desk	Standing	Walking\n" //
						+ "Sep 23 2015, 09:00 		6	17	1	4		258	51	28\n" //
						+ "Sep 23 2015, 10:00 		8	26	12	8	1	248	41	18\n" //
						+ "Sep 23 2015, 11:30 	3	8	25	18	15	3	272	42	19\n" //
						+ "Sep 23 2015, 12:30 		7	9	8	43	2	217	43	30\n" //
						+ "Sep 23 2015, 13:30 		5	12	32	14	3	282	37	14\n" //
						+ "Sep 23 2015, 15:00 	4	4	13	10	8	3	254	52	17\n" //
						+ "Sep 23 2015, 16:00 		6	18	28	2	5	255	29	31\n" //
						+ "Sep 23 2015, 17:00 	1	5	2		8	5	146	38	27\n" //
						+ "Sep 24 2015, 09:00 	6	2	11	36	7	6	224	34	23\n" //
						+ "Sep 24 2015, 10:00 	7	4	6	20	13	9	268	61	31\n" //
						+ "Sep 24 2015, 11:30 	1	7	18	21	6	16	282	43	22\n" //
						+ "Sep 24 2015, 12:30 		7	10	23	73	4	200	43	23\n" //
						+ "Sep 24 2015, 13:30 	2	6	11	19	24	11	267	26	18\n" //
						+ "Sep 24 2015, 15:00 	3	7	25	23	5	10	265	32	21\n" //
						+ "Sep 24 2015, 16:00 		9	28	8	3	6	262	39	14\n" //
						+ "Sep 24 2015, 17:00 		7	5	7	5	2	173	35	25\n" //
						+ "Sep 25 2015, 09:00 		6	2	23	12	2	232	46	31\n" //
						+ "Sep 25 2015, 10:00 		7	7	33	21	9	254	65	21\n" //
						+ "Sep 25 2015, 11:30 		8	27	18	11	11	256	52	21\n" //
						+ "Sep 25 2015, 12:30 		6	3	20	63	4	189	41	40\n" //
						+ "Sep 25 2015, 13:30 	5	7	10	20	22	3	275	41	29\n" //
						+ "Sep 25 2015, 15:00 	1	12	7	22	10	9	255	42	31\n" //
						+ "Sep 25 2015, 16:00 		4	13	31	4	6	210	35	25\n" //
						+ "Sep 25 2015, 17:00 	3	7	14	7	5	7	169	31	33\n" //
						+ "Sep 26 2015, 09:00 		6		13	6	3	249	47	23\n" //
						+ "Sep 26 2015, 10:00 		3	12	25	8	6	228	56	29\n" //
						+ "Sep 26 2015, 11:30 		6	15	20	17	7	235	51	32\n" //
						+ "Sep 26 2015, 12:30 		5	13	16	55	3	213	41	24\n" //
						+ "Sep 26 2015, 13:30 		5	27	11	18	5	249	41	25\n" //
						+ "Sep 26 2015, 15:00 	2	6	21	12	60	6	210	46	10\n" //
						+ "Sep 26 2015, 16:00 	1	4	15	12	53	4	211	23	14\n" //
						+ "Sep 26 2015, 17:00 	2	6	6	6	4	6	191	42	17\n" //
						+ "Sep 27 2015, 09:00 	3	6	1	38	11	2	186	58	19\n" //
						+ "Sep 27 2015, 10:00 	3	5	3	69	15	9	214	30	17\n" //
						+ "Sep 27 2015, 11:30 	3	6	10	17	24	8	222	21	16\n" //
						+ "Sep 27 2015, 12:30 	3	5	9	15	35	1	173	30	31\n" //
						+ "Sep 27 2015, 13:30 		4	10	5	19	6	243	40	17\n" //
						+ "Sep 27 2015, 15:00 	3	5	8	26	4	9	208	60	12\n" //
						+ "Sep 27 2015, 16:00 		4		25	2	5	198	38	19\n" //
						+ "Sep 27 2015, 17:00 		3	2		6		108	26	22"

				var data = d3.tsv.parse(str);

				data.forEach(function(d, idx) {

					var keys = Object.keys(d);
					for (var i = 0; i < keys.length; i++) {
						if (keys[i] === 'date')
							continue;
						if (d[keys[i]] === '')
							d[keys[i]] = 0;
					}
					d.idx = idx;
					d.date = new Date(Date.parse(d.date));
				});

				/* color.domain(d3.keys(data[0]).filter(function(key) {
					return key !== "date" && key !== "idx";
				})); */

				var activities = stack(color.domain().map(function(name) {
					return {
						name : name,
						values : data.map(function(d) {
							return {
								/* date : d.date, */
								idx : d.idx,
								y : parseFloat(d[name])
							};
						})
					};
				}));

				x.domain(d3.extent(data, function(d) {
					/* return d.date; */
					return d.idx;
				}));

				var activity = chart.selectAll(".activity").data(activities).enter()
						.append("g").attr("class", "activity").attr('id', function(d, i) {
							return 'actv-' + i;
						});

				activity.append("path").on('click', function(d, idx) {
					d3.selectAll('.activity').style('opacity', 0.2);
					d3.select('#actv-' + idx).style('opacity', 1);
					//d3.selectAll('#actv-' + idx + " rect").style('stroke', 'black');
				}).on('mouseout', function() {
					d3.selectAll('.activity').style('opacity', 1);
					//d3.selectAll('.activity rect').style('stroke', 'none');
				}).attr("class", "area").attr("d", function(d) {
					return area(d.values);
				}).style("fill", function(d) {
					return color(d.name);
				}).style('opacity', 0).transition().delay(function(d, i) {
					return 1000 + i * 100;
				}).duration(500).style('opacity', 1);
				/* .attrTween('d', function(d) {
					function interpolateFromNil(a) {
						var b = [];
						var i = a.length;
						while (i--) {
							b[i] = {
								y : 0,
								y0 : a[i].y0,
								idx : a[i].idx,
							}
						}
						return function(t) {
							var i = a.length;
							while (i--) {
								b[i].y = b[i].y * (1 - t) + a[i].y * t;
							}
							return b;
						}
					} 
					var i = interpolateFromNil(d.values);
					return function(t) {
						d.animVals = i(t);
						return area(d.animVals);
					}
				}); */

				var legendItems = activity.append("g").datum(function(d) {
					return {
						name : d.name,
						value : d.values[d.values.length - 1]
					};
				}).attr(
						"transform",
						function(d, idx) {
							/* return "translate(" + x(d.value.date) + "," + */
							return "translate(" + (width * 0.33 * (idx / 3 | 0)) + "," +
									(height + margin.top + 40 + (10 * (idx % 3))) + ")";
						}).on('click', function(d, idx) {
					d3.selectAll('.activity').style('opacity', 0.2);
					d3.select('#actv-' + idx).style('opacity', 1);
				}).on('mouseout', function() {
					d3.selectAll('.activity').style('opacity', 1);
				});

				legendItems.append('rect').attr('shape-rendering', 'crispEdges').attr(
						'y', -7.5).attr('width', 8).attr('height', 8).style("fill",
						function(d) {
							return color(d.name);
						});
				legendItems.append('text').attr("x", 10).attr("dy", ".35rem").text(
						function(d) {
							return d.name;
						});

				chart.append("g").attr("class", "x axis").attr("transform",
						"translate(0," + height + ")").call(xAxis).selectAll("text").style(
						"text-anchor", "end").attr("dx", "-.8em").attr("dy", ".15em").attr(
						"transform", "rotate(-90)");

				chart.append("g").attr("class", "y axis").call(yAxis);
			}
			function endsWith(str, suffix) {
				return str.match(suffix + "$") == suffix;
			}
			function loadSlide2() {
				loadDonner("#graph-3", [
						{
							name : "one",
							value : 44
						}, {
							name : "two",
							value : (100 - 44)
						}
				], 0);
				loadDonner("#graph-4", [
						{
							name : "one",
							value : 54
						}, {
							name : "two",
							value : (100 - 54)
						}
				], 500);
				loadDonner("#graph-5", [
						{
							name : "one",
							value : 21
						}, {
							name : "two",
							value : (100 - 21)
						}
				], 500);
				loadDonner("#graph-6", [
						{
							name : "one",
							value : 44
						}, {
							name : "two",
							value : 100 - 44
						}
				], 500);
				loadDonner("#graph-7", [
						{
							name : "one",
							value : 34
						}, {
							name : "two",
							value : 100 - 34
						}
				], 500);
			}
			function loadDonner(elementID, data, animDelay) {

				var margin = {
					top : 2,
					right : 2,
					bottom : 2,
					left : 2
				};
				var width = 150 - margin.left - margin.right;
				var height = 150 - margin.top - margin.bottom;

				var svg = d3.select(elementID);
				var svgstyle = svg.node().style;
				if (svgstyle.width) {
					var w = svgstyle.width;
					if (endsWith(w, 'rem'))
						w = 10 * parseInt(w.substring(0, w.indexOf('rem')));
					else if (endsWith(w, 'px'))
						w = parseInt(w.substring(0, w.indexOf('px')));
					else
						w = 150;
					width = w - margin.left - margin.right;
				}
				if (svgstyle.height) {
					var h = svgstyle.height;
					if (endsWith(h, 'rem'))
						h = 10 * parseInt(h.substring(0, h.indexOf('rem')));
					else if (endsWith(h, 'px'))
						h = parseInt(h.substring(0, h.indexOf('px')));
					else
						h = 150;

					height = h - margin.top - margin.bottom;
				}
				svg.selectAll('g').remove();
				/* svg.attr('viewbox', '0 0 ' + (width + margin.left + margin.right) +
									' ' + (height + margin.top + margin.bottom)); */
				/* .attr("width",
						width + margin.left + margin.right).attr("height",
						height + margin.top + margin.bottom) */
				var chart = svg.append("g").attr(
						"transform",
						"translate(" + ((width / 2) + margin.left) + "," +
								((height / 2) + margin.top) + ")");

				var radius = Math.min(width, height) / 2;

				var ringWidth = radius / 2;

				var color = d3.scale.ordinal().range([
						"#2DC3F0", "#F2902A"
				]);

				var arc = d3.svg.arc().outerRadius(radius).innerRadius(
						radius - ringWidth);
				var pie = d3.layout.pie().sort(null).startAngle(0)
						.endAngle(2 * Math.PI).value(function(d) {
							return d.value;
						});

				var g = chart.selectAll(".arc").data(pie(data)).enter().append("g")
						.attr("class", "arc");

				g.append("path").style('stroke', 'white')
						.style('stroke-width', '1.5px').style("fill", function(d) {
							return color(d.data.name);
						}).transition().delay(animDelay).duration(500).attrTween('d',
								function(d, idx) {
									//console.log(idx);
									if (idx === 0) {
										var i = d3.interpolate(d.startAngle + 0.1, d.endAngle);
										return function(t) {
											d.endAngle = i(t);
											return arc(d);
										}
									} else {
										var i = d3.interpolate(0, d.startAngle);
										return function(t) {
											d.startAngle = i(t);
											return arc(d);
										}
									}
								});

				var text = chart.append('text').attr('font-family', 'Apercu').attr(
						'font-size', '1.4em').attr('text-anchor', 'middle').attr('dy',
						'.3em').attr('x', 0).attr('y', 0).style('fill', 'black').text('')
						.transition().delay(animDelay).duration(500).tween(
								'text',
								function(d) {
									var val = 100 * data[0].value /
											(data[0].value + data[1].value);
									var i = d3.interpolate(0, val);
									return function(t) {
										this.textContent = (i(t) | 0) + '%';
									}
								});
			}
			function loadSlide4() {
				loadMadonna("#graph-9", [
						{
							name : "Workspace",
							value : 29
						}, {
							name : "Shared facilities",
							value : 50
						}, {
							name : "Primary circulation",
							value : 21
						}
				], 0);
				loadMadonna("#graph-10", [
						{
							name : "Workspace",
							value : 25
						}, {
							name : "Shared facilities",
							value : 52
						}, {
							name : "Primary circulation",
							value : 23
						}
				], 500);
				loadMadonna("#graph-11", [
						{
							name : "Workspace",
							value : 43
						}, {
							name : "Shared facilities",
							value : 44
						}, {
							name : "Primary circulation",
							value : 13
						}
				], 1000);
			}
			function loadMadonna(elementID, data, animDelay) {
				var margin = {
					top : 2,
					right : 2,
					bottom : 2,
					left : 2
				};
				var width = 150 - margin.left - margin.right;
				var height = 150 - margin.top - margin.bottom;

				var svg = d3.select(elementID);
				var svgstyle = svg.node().style;
				if (svgstyle.width) {
					var w = svgstyle.width;
					if (endsWith(w, 'rem'))
						w = 10 * parseInt(w.substring(0, w.indexOf('rem')));
					else if (endsWith(w, 'px'))
						w = parseInt(w.substring(0, w.indexOf('px')));
					else
						w = 150;
					width = w - margin.left - margin.right;
				}
				if (svgstyle.height) {
					var h = svgstyle.height;
					if (endsWith(h, 'rem'))
						h = 10 * parseInt(h.substring(0, h.indexOf('rem')));
					else if (endsWith(h, 'px'))
						h = parseInt(h.substring(0, h.indexOf('px')));
					else
						h = 150;

					height = h - margin.top - margin.bottom;
				}
				svg.selectAll('g').remove();
				/* svg.attr('viewbox', '0 0 ' + (width + margin.left + margin.right) +
						' ' + (height + margin.top + margin.bottom)); */
				/* .attr("width",
						width + margin.left + margin.right).attr("height",
						height + margin.top + margin.bottom) */
				var chart = svg.append("g").attr(
						"transform",
						"translate(" + ((width / 2) + margin.left) + "," +
								((height / 2) + margin.top) + ")");

				var radius = Math.min(width, height) / 2;

				var ringWidth = radius / 2;

				var color = d3.scale.ordinal().range([
						"#032060", "#0F70C0", "#FB0106"
				]);

				var arc = d3.svg.arc().outerRadius(radius).innerRadius(
						radius - ringWidth);
				var pie = d3.layout.pie().sort(null).startAngle(0)
						.endAngle(2 * Math.PI).value(function(d) {
							return d.value;
						});

				var g = chart.selectAll(".arc").data(pie(data)).enter().append("g")
						.attr("class", "arc");

				g.append("path").style('stroke', 'white')
						.style('stroke-width', '1.5px').style("fill", function(d) {
							return color(d.data.name);
						}).transition().delay(function(d, i) {
							return i * 500;
						}).duration(500).attrTween('d', function(d) {
							var i = d3.interpolate(d.startAngle + 0.1, d.endAngle);
							return function(t) {
								d.endAngle = i(t);
								return arc(d);
							}
						});
				var text = chart.selectAll('text').data(pie(data)).enter().append(
						'text').attr('font-family', 'Apercu').attr('font-size',
						(1.2 * (width / 150)) + 'rem').attr('text-anchor', 'middle').attr(
						'dy', '.3em').attr('x', function(d) {
					return arc.centroid(d)[0];
				}).attr('y', function(d) {
					return arc.centroid(d)[1];
				}).style('fill', 'white').transition().delay(function(d, i) {
					return 250 + i * 500;
				}).duration(250).tween('text', function(d, idx) {
					var total = 0;
					for (var i = 0; i < data.length; i++)
						total += data[i].value;
					var val = 100 * data[idx].value / total;
					var i = d3.interpolate(0, val);
					return function(t) {
						this.textContent = (i(t) | 0) + '%';
					}
				});
			}
			function loadSlide3() {
				loadStackedBarChart("#graph-8");
			}
			function loadStackedBarChart(elementID) {

				var margin = {
					top : 20,
					right : 20,
					bottom : 200,
					left : 40
				}, width = 960 - margin.left - margin.right, height = 240 - margin.top -
						margin.bottom;

				var svg = d3.select(elementID);
				var svgstyle = svg.node().style;
				if (svgstyle.width) {
					var w = svgstyle.width;
					if (endsWith(w, 'rem'))
						w = 10 * parseInt(w.substring(0, w.indexOf('rem')));
					else if (endsWith(w, 'px'))
						w = parseInt(w.substring(0, w.indexOf('px')));
					else
						w = 150;
					width = w - margin.left - margin.right;
				}
				if (svgstyle.height) {
					var h = svgstyle.height;
					if (endsWith(h, 'rem'))
						h = 10 * parseInt(h.substring(0, h.indexOf('rem')));
					else if (endsWith(h, 'px'))
						h = parseInt(h.substring(0, h.indexOf('px')));
					else
						h = 150;

					height = h - margin.top - margin.bottom;
				}
				svg.selectAll('g').remove();

				var x = d3.scale.ordinal().rangeRoundBands([
						0, width
				], .1);

				var y = d3.scale.linear().rangeRound([
						height, 0
				]);

				var color = d3.scale.ordinal().range([
						"#2DC3F0", "#F2902A"
				]);

				var xAxis = d3.svg.axis().scale(x).orient("bottom");

				var yAxis = d3.svg.axis().scale(y).orient("left").tickFormat(
						d3.format(".2s"));

				var chart = svg.append("g").attr("width",
						width + margin.left + margin.right).attr("height",
						height + margin.top + margin.bottom).attr("transform",
						"translate(" + margin.left + "," + margin.top + ")");

				var str = "polygon_type	Average Occupancy	Number of Desks	Peak Occupancy\n" //
						+ "3DESKS 	18	3	100\n" //
						+ "BRANDSOCIAL 	24	8	63\n" //
						+ "CatProduction&Creative 	35	80	49\n" //
						+ "CREATIVEPRODUCTION 	51	22	91\n" //
						+ "CRM 	52	10	90\n" //
						+ "CUSTOMERINSIGHT 	24	3	100\n" //
						+ "CustomerServicesLondon 	37	64	53\n" //
						+ "DIGITAL 	63	8	100\n" //
						+ "EthicalTrading 	39	2	100\n" //
						+ "Exec 	31	5	100\n" //
						+ "Finance 	50	29	86\n" //
						+ "GeneralMaketing&PR 	27	6	50\n" //
						+ "HR(includingFacilities) 	46	13	77\n" //
						+ "INTERNATIONAL 	55	8	88\n" //
						+ "IT 	43	64	58\n" //
						+ "MARKVACANT 	33	2	50\n" //
						+ "MenswearBuying 	30	3	67\n" //
						+ "MenswearDesign 	5	1	100\n" //
						+ "MenswearGarmentTechnology 	40	4	75\n" //
						+ "MenswearMerchendising 	60	2	100\n" //
						+ "Mini&JonniebBuying 	37	22	55\n" //
						+ "Mini&JonniebDesign 	45	28	68\n" //
						+ "Mini&JonniebGarmentTechnology 	41	18	67\n" //
						+ "Mini&JonniebMerchandising 	55	16	88\n" //
						+ "PAs 	79	2	100\n" //
						+ "PLANNING&ANALYSIS 	66	9	89\n" //
						+ "TRADE 	21	3	67\n" //
						+ "UnallocatedDesk 	7	47	19\n" //
						+ "WebTeam 	42	20	70\n" //
						+ "WomenswearBuying 	38	25	60\n" //
						+ "WomenswearDesign 	42	23	65\n" //
						+ "WomenswearMerchendising 	54	25	76\n" //
						+ "WomenswearProductTechnology 	33	18	56";

				var data = d3.tsv.parse(str);

				color.domain(d3.keys(data[0]).filter(function(key) {
					return key !== "polygon_type" && key !== 'Number of Desks';
				}));

				data.forEach(function(d) {
					// TODO implementation specific:
					d['Peak Occupancy'] -= d['Average Occupancy'];
					d.polygon_type += ' (' + d['Number of Desks'] + ')'
					// end implementation specific
					var y0 = 0;
					d.ages = color.domain().map(function(name) {
						return {
							name : name,
							y0 : y0,
							y1 : y0 += +d[name]
						};
					});
					d.total = d.ages[d.ages.length - 1].y1;
				});

				data.sort(function(a, b) {
					return b['Number of Desks'] - a['Number of Desks'];
				});

				x.domain(data.map(function(d) {
					return d.polygon_type;
				}));
				y.domain([
						0, d3.max(data, function(d) {
							return d.total;
						})
				]);

				chart.append("g").attr("class", "x axis").attr("transform",
						"translate(0," + height + ")").call(xAxis).selectAll("text").style(
						"text-anchor", "end").attr("dx", "-.8em").attr("dy", "-1em").attr(
						"transform", "rotate(-90)");
				;

				chart.append("g").attr("class", "y axis").call(yAxis).append("text")
						.attr("transform", "rotate(-90)").attr("y", 6).attr("dy", ".71em")
						.style("text-anchor", "end").text("Population");

				var state = chart.selectAll(".state").data(data).enter().append("g")
						.attr("class", "g").attr(
								"transform",
								function(d) {
									return "translate(" +
											(x(d.polygon_type) - x.rangeBand() * 0.25) + ",0)";
								});

				state.selectAll("rect").data(function(d) {
					return d.ages;
				}).enter().append("rect").attr("width", x.rangeBand() * 0.5).style(
						"fill", function(d) {
							return color(d.name);
						}).transition().delay(function(d, i) {
					return i * 500;
				}).duration(500).attrTween("y", function(d) {
					var startY = y(d.y0);
					var finalY = y(d.y1);
					var i = d3.interpolate(startY, finalY);
					return function(t) {
						return i(t);
					};
				}).attrTween("height", function(d) {
					var finalY = y(d.y0) - y(d.y1);
					var i = d3.interpolate(0, finalY);
					return function(t) {
						return i(t);
					};
				});

				var legend = chart.selectAll(".legend").data(
						color.domain().slice().reverse()).enter().append("g").attr("class",
						"legend").attr("transform", function(d, i) {
					return "translate(0," + i * 20 + ")";
				});

				legend.append("rect").attr("x", width - 18).attr("width", 18).attr(
						"height", 18).style("fill", color);

				legend.append("text").attr("x", width - 24).attr("y", 9).attr("dy",
						".35em").style("text-anchor", "end").text(function(d) {
					return d;
				});

			}
		</script>

</body>
</html>